{
  "type": "script",
  "enabled": false,
  "name": "Instagram (RU)",
  "id": "33c0b14c-4503-40e0-8c9e-187facccc722",
  "content": "import'https://testingcf.jsdelivr.net/npm/vue3-draggable-resizable/dist/Vue3DraggableResizable.css/+esm';var n={163:(n,e,t)=>{var a=t(202);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[n.id,a,'']]),a.locals&&(n.exports=a.locals);(0,t(424).A)('368e5c40',a,!1,{ssrId:!0})},202:(n,e,t)=>{t.r(e),t.d(e,{default:()=>r});var a=t(314),i=t.n(a),o=t(378),s=t.n(o)()(i());s.push([n.id,'@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap);']),s.push([n.id,'.lyrics-widget[data-v-56cdfa4a]{position:absolute;top:20%;left:50%;transform:translate(-50%,-50%);width:58px;height:58px;border-radius:50%;box-shadow:0 4px 10px rgba(0,0,0,0.1);-webkit-user-select:none;user-select:none;background:transparent;transition:width 0.3s cubic-bezier(0.2,0.8,0.2,1),height 0.3s cubic-bezier(0.2,0.8,0.2,1),border-radius 0.3s ease,background 0.3s ease;cursor:pointer;z-index:9999999;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,\\'Segoe UI\\',Roboto,Helvetica,Arial,sans-serif;color:#262626}.story-ring[data-v-56cdfa4a]{position:absolute;inset:0;border-radius:50%;padding:2px;background:linear-gradient(45deg,#f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);-webkit-mask:linear-gradient(#fff 0 0) content-box,linear-gradient(#fff 0 0);-webkit-mask-composite:xor;mask-composite:exclude;transition:opacity 0.2s;pointer-events:none}.avatar-collapsed[data-v-56cdfa4a]{position:absolute;inset:5px;border-radius:50%;background:#fafafa;display:flex;align-items:center;justify-content:center;overflow:hidden;transition:opacity 0.2s}.avatar-img[data-v-56cdfa4a]{width:100%;height:100%;object-fit:cover;-webkit-user-select:none;user-select:none;-webkit-user-drag:none;pointer-events:none}.lyrics-widget.expanded[data-v-56cdfa4a]{width:330px;height:auto;min-height:400px;background:#ffffff;border-radius:8px;border:1px solid #dbdbdb;box-shadow:0 8px 24px rgba(0,0,0,0.15);cursor:default;display:flex;flex-direction:column}.lyrics-widget.expanded .story-ring[data-v-56cdfa4a],.lyrics-widget.expanded .avatar-collapsed[data-v-56cdfa4a]{opacity:0;pointer-events:none}.lyrics-widget.dragging[data-v-56cdfa4a]{cursor:grabbing;transform:translate(-50%,-50%) scale(1.02);transition:none}.content[data-v-56cdfa4a]{display:flex;flex-direction:column;height:100%;opacity:0;pointer-events:none;transition:opacity 0.1s ease}.lyrics-widget.expanded .content[data-v-56cdfa4a]{opacity:1;pointer-events:auto;transition:opacity 0.3s ease 0.1s}.ins-header[data-v-56cdfa4a]{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #efefef;height:60px;box-sizing:border-box}.ins-avatar-group[data-v-56cdfa4a]{display:flex;align-items:center;gap:10px;overflow:hidden}.ins-avatar-small[data-v-56cdfa4a]{width:32px;height:32px;border-radius:50%;overflow:hidden;flex-shrink:0}.avatar-img-small[data-v-56cdfa4a]{width:100%;height:100%;object-fit:cover}.ins-meta[data-v-56cdfa4a]{display:flex;flex-direction:column;overflow:hidden}.ins-username[data-v-56cdfa4a]{font-size:14px;font-weight:600;color:#262626;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ins-location[data-v-56cdfa4a]{font-size:12px;color:#262626;line-height:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ins-more[data-v-56cdfa4a]{color:#262626;padding-left:10px;cursor:pointer;font-size:14px}.ins-content-area[data-v-56cdfa4a]{width:100%;min-height:250px;background:#fafafa;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;border-bottom:1px solid #efefef;flex:1}.lyrics-wrapper[data-v-56cdfa4a]{padding:20px;text-align:center;width:100%}.lyric-line[data-v-56cdfa4a]{transition:all 0.4s ease;font-family:-apple-system,BlinkMacSystemFont,\\'Segoe UI\\',Roboto,sans-serif;margin:6px 0}.lyric-line.current[data-v-56cdfa4a]{font-size:20px;font-weight:600;color:#262626;line-height:1.4}.lyric-line.next[data-v-56cdfa4a]{font-size:14px;color:#8e8e8e}.playlist-wrapper[data-v-56cdfa4a]{width:100%;height:100%;display:flex;flex-direction:column;position:absolute;top:0;left:0;background:#fff}.search-bar[data-v-56cdfa4a]{padding:10px 15px;border-bottom:1px solid #efefef;display:flex;align-items:center;background:#fafafa}.search-icon[data-v-56cdfa4a]{color:#8e8e8e;font-size:12px;margin-right:8px}.search-bar input[data-v-56cdfa4a]{border:none;background:transparent;width:100%;font-size:14px;outline:none;color:#262626}.song-list[data-v-56cdfa4a]{flex:1;overflow-y:auto;list-style:none;padding:0;margin:0}.song-item[data-v-56cdfa4a]{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background 0.1s}.song-item[data-v-56cdfa4a]:hover{background:#fafafa}.song-item.is-playing[data-v-56cdfa4a]{background:#f0f8ff;border-left:3px solid #0095f6}.song-info[data-v-56cdfa4a]{display:flex;align-items:center;overflow:hidden;flex:1}.song-num[data-v-56cdfa4a]{font-size:12px;color:#8e8e8e;width:24px;flex-shrink:0}.song-title[data-v-56cdfa4a]{font-size:14px;color:#262626;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:10px}.is-playing .song-title[data-v-56cdfa4a]{font-weight:600;color:#0095f6}.delete-btn[data-v-56cdfa4a]{color:#c7c7c7;padding:5px;font-size:12px}.delete-btn[data-v-56cdfa4a]:hover{color:#ed4956}.empty-tip[data-v-56cdfa4a]{padding:20px;text-align:center;color:#8e8e8e;font-size:13px}.ins-actions[data-v-56cdfa4a]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;height:54px;box-sizing:border-box}.left-actions[data-v-56cdfa4a]{display:flex;align-items:center;gap:16px}.ins-btn[data-v-56cdfa4a]{background:none;border:none;padding:0;cursor:pointer;color:#262626;transition:transform 0.1s;display:flex;align-items:center;justify-content:center}.ins-btn i[data-v-56cdfa4a]{font-size:24px}.ins-btn[data-v-56cdfa4a]:hover{opacity:0.7}.ins-btn[data-v-56cdfa4a]:active{transform:scale(0.9)}.btn-like.is-active i[data-v-56cdfa4a]{color:#ed4956;animation:heart-beat-56cdfa4a 0.3s cubic-bezier(0.175,0.885,0.32,1.275)}@keyframes heart-beat-56cdfa4a{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}.right-actions[data-v-56cdfa4a]{width:80px;display:flex;align-items:center}.ins-likes[data-v-56cdfa4a],.ins-caption[data-v-56cdfa4a]{padding:0 16px;font-size:14px;color:#262626;line-height:18px;margin-bottom:6px}.ins-likes[data-v-56cdfa4a]{margin-bottom:8px}.ins-likes b[data-v-56cdfa4a],.ins-caption b[data-v-56cdfa4a]{font-weight:600}.ins-caption[data-v-56cdfa4a]{margin-bottom:16px}.caption-text[data-v-56cdfa4a]{font-weight:400}.volume-slider[data-v-56cdfa4a]{-webkit-appearance:none !important;appearance:none !important;background:transparent !important;filter:none !important;border:none !important;border-radius:0 !important;box-shadow:none !important;margin:0 !important;padding:0 !important;width:100% !important;height:100% !important;display:flex;align-items:center;cursor:pointer !important}.volume-slider[data-v-56cdfa4a]::-webkit-slider-runnable-track{width:100%;height:2px;border:none;background-image:linear-gradient(90deg,#262626 0%,#262626 var(--volume-fill,0%),#dbdbdb var(--volume-fill,0%),#dbdbdb 100%);background-size:100% 100% !important;background-repeat:no-repeat;-webkit-appearance:none !important}.volume-slider[data-v-56cdfa4a]::-webkit-slider-thumb{-webkit-appearance:none !important;appearance:none !important;height:10px !important;width:10px !important;border-radius:50% !important;background:#262626 !important;margin-top:-4px !important;border:none !important;box-shadow:none !important}.volume-slider[data-v-56cdfa4a]::-moz-range-track{width:100%;height:2px;border:none !important;background-image:linear-gradient(90deg,#262626 0%,#262626 var(--volume-fill,0%),#dbdbdb var(--volume-fill,0%),#dbdbdb 100%)}.volume-slider[data-v-56cdfa4a]::-moz-range-thumb{height:10px !important;width:10px !important;border:none !important;border-radius:50% !important;background:#262626 !important}.lyrics-widget.near-boundary[data-v-56cdfa4a]{box-shadow:0 0 0 2px #ed4956}@media (max-width:480px){.lyrics-widget.expanded[data-v-56cdfa4a]{width:90%;max-width:350px}}.avatar-collapsed[data-v-56cdfa4a]{position:absolute;inset:5px;border-radius:50%;background:#fafafa;display:flex;align-items:center;justify-content:center;overflow:hidden;cursor:pointer}.expand-overlay[data-v-56cdfa4a]{position:absolute;inset:0;background:rgba(0,0,0,0.3);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s;z-index:10}.lyrics-widget:hover .expand-overlay[data-v-56cdfa4a],.expand-overlay[data-v-56cdfa4a]{opacity:1;background:rgba(0,0,0,0.1)}.expand-overlay i[data-v-56cdfa4a]{color:white;font-size:20px;text-shadow:0 1px 3px rgba(0,0,0,0.5)}.ins-header[data-v-56cdfa4a]{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #efefef;height:60px}.header-actions[data-v-56cdfa4a]{display:flex;align-items:center;gap:15px}.ins-icon-btn[data-v-56cdfa4a]{color:#262626;cursor:pointer;font-size:16px;padding:5px;transition:transform 0.1s}.ins-icon-btn[data-v-56cdfa4a]:active{transform:scale(0.9)}.close-btn[data-v-56cdfa4a]{color:#8e8e8e}.close-btn[data-v-56cdfa4a]:hover{color:#262626}.ins-content-area[data-v-56cdfa4a]{cursor:default}.lyrics-widget[data-v-56cdfa4a]{overflow:visible}.expand-badge-btn[data-v-56cdfa4a]{position:absolute;top:-2px;right:-2px;width:24px;height:24px;background:#fff;border-radius:50%;box-shadow:0 2px 6px rgba(0,0,0,0.2);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:20;transition:transform 0.2s cubic-bezier(0.34,1.56,0.64,1)}.expand-badge-btn i[data-v-56cdfa4a]{font-size:12px;background:-webkit-linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888);-webkit-background-clip:text;-webkit-text-fill-color:transparent;color:#cc2366}.expand-badge-btn[data-v-56cdfa4a]:hover{transform:scale(1.15)}.expand-badge-btn[data-v-56cdfa4a]:active{transform:scale(0.9)}.lyrics-widget.expanded .expand-badge-btn[data-v-56cdfa4a]{opacity:0;pointer-events:none;transform:scale(0)}.avatar-collapsed[data-v-56cdfa4a]{z-index:1;cursor:grab}.lyrics-widget.dragging .avatar-collapsed[data-v-56cdfa4a]{cursor:grabbing}.header-actions[data-v-56cdfa4a]{display:flex;align-items:center;gap:12px}.ins-icon-btn[data-v-56cdfa4a]{padding:8px;cursor:pointer;color:#262626;font-size:16px}.expand-badge-btn[data-v-56cdfa4a]{position:absolute;top:0px;right:0px;width:24px;height:24px;border-radius:50%;background:rgba(255,255,255,0.4);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.6);box-shadow:0 4px 10px rgba(0,0,0,0.15);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:20;transition:all 0.3s cubic-bezier(0.25,0.8,0.25,1)}.expand-badge-btn i[data-v-56cdfa4a]{font-size:11px;color:#333}.expand-badge-btn[data-v-56cdfa4a]:hover{background:rgba(255,255,255,0.65);transform:scale(1.1);box-shadow:0 6px 14px rgba(0,0,0,0.2)}.expand-badge-btn[data-v-56cdfa4a]:active{transform:scale(0.9)}.lyrics-widget.expanded .expand-badge-btn[data-v-56cdfa4a]{opacity:0;pointer-events:none;transform:scale(0);transition:transform 0.2s,opacity 0.2s}\\n','',{version:3,sources:['webpack://./src/ins风格Играть器/musicИгратьer.vue'],names:[],mappings:'AAirBA,gCACE,iBAAkB,CAClB,OAAQ,CACR,QAAS,CACT,8BAAgC,CAChC,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,qCAAyC,CACzC,wBAAiB,CAAjB,gBAAiB,CACjB,sBAAuB,CACvB,sIAIsB,CACtB,cAAe,CACf,eAAgB,CAChB,eAAgB,CAChB,yFAAgG,CAChG,aACF,CAGA,6BACE,iBAAkB,CAClB,OAAQ,CACR,iBAAkB,CAClB,WAAY,CACZ,6FAAmG,CACnG,4EAE2B,CAC3B,0BAA2B,CAC3B,sBAAuB,CACvB,uBAAwB,CACxB,mBACF,CAGA,mCACE,iBAAkB,CAClB,SAAU,CACV,iBAAkB,CAClB,kBAAmB,CACnB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,eAAgB,CAChB,uBACF,CAGA,6BACE,UAAW,CACX,WAAY,CACZ,gBAAiB,CAEjB,wBAAiB,CAAjB,gBAAiB,CACjB,sBAAuB,CACvB,mBACF,CAGA,yCACE,WAAY,CACZ,WAAY,CACZ,gBAAiB,CACjB,kBAAmB,CACnB,iBAAkB,CAClB,wBAAyB,CACzB,sCAA0C,CAC1C,cAAe,CACf,YAAa,CACb,qBACF,CAEA,gHAEE,SAAU,CACV,mBACF,CAEA,yCACE,eAAgB,CAChB,0CAA4C,CAC5C,eACF,CAGA,0BACE,YAAa,CACb,qBAAsB,CACtB,WAAY,CACZ,SAAU,CACV,mBAAoB,CACpB,4BACF,CAEA,kDACE,SAAU,CACV,mBAAoB,CACpB,iCACF,CAGA,6BACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,iBAAkB,CAClB,+BAAgC,CAChC,WAAY,CACZ,qBACF,CAEA,mCACE,YAAa,CACb,kBAAmB,CACnB,QAAS,CACT,eACF,CAEA,mCACE,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,eAAgB,CAChB,aACF,CAGA,mCACE,UAAW,CACX,WAAY,CACZ,gBACF,CAEA,2BACE,YAAa,CACb,qBAAsB,CACtB,eACF,CAEA,+BACE,cAAe,CACf,eAAgB,CAChB,aAAc,CACd,gBAAiB,CACjB,kBAAmB,CACnB,eAAgB,CAChB,sBACF,CAEA,+BACE,cAAe,CACf,aAAc,CACd,gBAAiB,CACjB,kBAAmB,CACnB,eAAgB,CAChB,sBACF,CAEA,2BACE,aAAc,CACd,iBAAkB,CAClB,cAAe,CACf,cACF,CAGA,mCACE,UAAW,CACX,gBAAiB,CACjB,kBAAmB,CACnB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,iBAAkB,CAClB,eAAgB,CAChB,+BAAgC,CAChC,MACF,CAGA,iCACE,YAAa,CACb,iBAAkB,CAClB,UACF,CAEA,6BACE,wBAAyB,CACzB,yEAA8E,CAC9E,YACF,CAEA,qCACE,cAAe,CACf,eAAgB,CAChB,aAAc,CACd,eACF,CAEA,kCACE,cAAe,CACf,aACF,CAGA,mCACE,UAAW,CACX,WAAY,CACZ,YAAa,CACb,qBAAsB,CACtB,iBAAkB,CAClB,KAAM,CACN,MAAO,CACP,eACF,CAEA,6BACE,iBAAkB,CAClB,+BAAgC,CAChC,YAAa,CACb,kBAAmB,CACnB,kBACF,CAEA,8BACE,aAAc,CACd,cAAe,CACf,gBACF,CAEA,mCACE,WAAY,CACZ,sBAAuB,CACvB,UAAW,CACX,cAAe,CACf,YAAa,CACb,aACF,CAEA,4BACE,MAAO,CACP,eAAgB,CAChB,eAAgB,CAChB,SAAU,CACV,QACF,CAEA,4BACE,YAAa,CACb,6BAA8B,CAC9B,kBAAmB,CACnB,iBAAkB,CAClB,+BAAgC,CAChC,cAAe,CACf,0BACF,CAEA,kCACE,kBACF,CAEA,uCACE,kBAAmB,CACnB,6BACF,CAEA,4BACE,YAAa,CACb,kBAAmB,CACnB,eAAgB,CAChB,MACF,CAEA,2BACE,cAAe,CACf,aAAc,CACd,UAAW,CACX,aACF,CAEA,6BACE,cAAe,CACf,aAAc,CACd,kBAAmB,CACnB,eAAgB,CAChB,sBAAuB,CACvB,iBACF,CAEA,yCACE,eAAgB,CAChB,aACF,CAEA,6BACE,aAAc,CACd,WAAY,CACZ,cACF,CACA,mCACE,aACF,CAEA,4BACE,YAAa,CACb,iBAAkB,CAClB,aAAc,CACd,cACF,CAGA,8BACE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,iBAAkB,CAClB,WAAY,CACZ,qBACF,CAEA,+BACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,0BACE,eAAgB,CAChB,WAAY,CACZ,SAAU,CACV,cAAe,CACf,aAAc,CACd,yBAA0B,CAC1B,YAAa,CACb,kBAAmB,CACnB,sBACF,CAEA,4BACE,cACF,CAEA,gCACE,WACF,CAEA,iCACE,oBACF,CAEA,uCACE,aAAc,CACd,uEACF,CAEA,+BACE,GACE,kBACF,CACA,IACE,oBACF,CACA,KACE,kBACF,CACF,CAEA,gCACE,UAAW,CACX,YAAa,CACb,kBACF,CAGA,0DAEE,cAAe,CACf,cAAe,CACf,aAAc,CACd,gBAAiB,CACjB,iBACF,CAEA,4BACE,iBACF,CAEA,8DAEE,eACF,CAEA,8BACE,kBACF,CAEA,+BACE,eACF,CAGA,gCACE,kCAAmC,CACnC,0BAA2B,CAC3B,iCAAkC,CAClC,sBAAuB,CACvB,sBAAuB,CACvB,0BAA2B,CAC3B,0BAA2B,CAC3B,mBAAoB,CACpB,oBAAqB,CACrB,qBAAsB,CACtB,sBAAuB,CACvB,YAAa,CACb,kBAAmB,CACnB,yBACF,CAEA,+DACE,UAAW,CACX,UAAW,CACX,WAAY,CACZ,2HAMC,CACD,oCAAqC,CACrC,2BAA4B,CAC5B,kCACF,CAEA,sDACE,kCAAmC,CACnC,0BAA2B,CAC3B,sBAAuB,CACvB,qBAAsB,CACtB,4BAA6B,CAC7B,6BAA8B,CAC9B,0BAA2B,CAC3B,sBAAuB,CACvB,0BACF,CAEA,kDACE,UAAW,CACX,UAAW,CACX,sBAAuB,CACvB,2HAOF,CACA,kDACE,sBAAuB,CACvB,qBAAsB,CACtB,sBAAuB,CACvB,4BAA6B,CAC7B,6BACF,CAEA,8CACE,4BACF,CAEA,yBACE,yCACE,SAAU,CACV,eACF,CACF,CAEA,mCAEE,iBAAkB,CAClB,SAAU,CACV,iBAAkB,CAClB,kBAAmB,CACnB,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,eAAgB,CAEhB,cACF,CAGA,iCACE,iBAAkB,CAClB,OAAQ,CACR,0BAA8B,CAC9B,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,SAAU,CACV,uBAAwB,CACxB,UACF,CAGA,uFAIE,SAAU,CACV,0BACF,CAEA,mCACE,WAAY,CACZ,cAAe,CACf,qCACF,CAGA,6BAEE,YAAa,CACb,kBAAmB,CACnB,6BAA8B,CAC9B,iBAAkB,CAClB,+BAAgC,CAChC,WACF,CAEA,iCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CAEA,+BACE,aAAc,CACd,cAAe,CACf,cAAe,CACf,WAAY,CACZ,yBACF,CAEA,sCACE,oBACF,CAEA,4BACE,aACF,CACA,kCACE,aACF,CAGA,mCACE,cACF,CAGA,gCAGE,gBACF,CAGA,mCACE,iBAAkB,CAClB,QAAS,CACT,UAAW,CACX,UAAW,CACX,WAAY,CACZ,eAAgB,CAChB,iBAAkB,CAClB,oCAAwC,CACxC,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,cAAe,CACf,UAAW,CACX,wDACF,CAEA,qCACE,cAAe,CACf,iFAAuF,CACvF,4BAA6B,CAC7B,mCAAoC,CAEpC,aACF,CAGA,yCACE,qBACF,CAEA,0CACE,oBACF,CAGA,2DACE,SAAU,CACV,mBAAoB,CACpB,kBACF,CAGA,mCAGE,SAAU,CAEV,WACF,CAEA,2DACE,eACF,CAGA,iCACE,YAAa,CACb,kBAAmB,CACnB,QACF,CACA,+BACE,WAAY,CACZ,cAAe,CACf,aAAc,CACd,cACF,CAEA,mCAEE,iBAAkB,CAClB,OAAQ,CACR,SAAU,CAGV,UAAW,CACX,WAAY,CACZ,iBAAkB,CAGlB,gCAAoC,CACpC,yBAA0B,CAC1B,iCAAkC,CAClC,sCAA0C,CAC1C,sCAA0C,CAG1C,YAAa,CACb,kBAAmB,CACnB,sBAAuB,CACvB,cAAe,CACf,UAAW,CACX,iDACF,CAGA,qCACE,cAAe,CAEf,UAKF,CAGA,yCACE,iCAAqC,CACrC,oBAAqB,CACrB,qCACF,CAGA,0CACE,oBACF,CAGA,2DACE,SAAU,CACV,mBAAoB,CACpB,kBAAmB,CACnB,sCAGF',sourcesContent:['<template>\\n  <div\\n    id=\"lyricsWidget\"\\n    ref=\"widget\"\\n    class=\"lyrics-widget player-card\"\\n    :style=\"`top:${dragY};left:${dragX}`\"\\n    @mousedown=\"startDrag\"\\n    @touchstart=\"startDrag\"\\n    @contextmenu=\"onContextMenu\"\\n  >\\n    <div class=\"story-ring\"></div>\\n\\n    \\x3c!-- 找到这一块 --\\x3e\\n    <div class=\"avatar-collapsed\">\\n      \\x3c!-- 修改这行 img 标签 --\\x3e\\n      \\x3c!-- 1. draggable=\"false\": 告诉浏览器这图不能拖出去 --\\x3e\\n      \\x3c!-- 2. style=\"pointer-events: none\": 让鼠标点击直接穿透到父容器，彻底杜绝图片被选中 --\\x3e\\n      <img :src=\"avatarSrc\" alt=\"Avatar\" class=\"avatar-img\" draggable=\"false\" style=\"pointer-events: none\" />\\n    </div>\\n\\n    \\x3c!-- 右上角小气泡，点击这里展开 --\\x3e\\n    <div class=\"expand-badge-btn\" @click.stop=\"expandWidget\" @touchstart.stop=\"expandWidget\">\\n      <i class=\"fas fa-expand-arrows-alt\"></i>\\n    </div>\\n\\n    \\x3c!-- === 展开状态 (保持之前的逻辑) === --\\x3e\\n    <div class=\"content\">\\n      <div class=\"ins-header\">\\n        <div class=\"ins-avatar-group\">\\n          <div class=\"ins-avatar-small\" @click.stop=\"triggerFileSelect\">\\n            <img :src=\"avatarSrc\" class=\"avatar-img\" />\\n          </div>\\n          <input ref=\"fileInputRef\" type=\"file\" accept=\"image/*\" style=\"display: none\" @change=\"handleAvatarChange\" />\\n          <div class=\"ins-meta\">\\n            <div class=\"ins-username\">{{ currentSinger || \\'Неизвестный исполнитель\\' }}</div>\\n            <div class=\"ins-location\">{{ currentSong || \\'Музыкальный плеер\\' }}</div>\\n          </div>\\n        </div>\\n\\n        \\x3c!-- 头部按钮 --\\x3e\\n        <div class=\"header-actions\">\\n          \\x3c!-- 列表按钮 --\\x3e\\n          <div class=\"ins-icon-btn\" @click.stop=\"toggleViewMode\">\\n            <i class=\"fas\" :class=\"showИгратьlist ? \\'fa-align-left\\' : \\'fa-list\\'\"></i>\\n          </div>\\n          \\x3c!-- 收起按钮 --\\x3e\\n          <div class=\"ins-icon-btn close-btn\" @click.stop=\"collapseWidget\">\\n            <i class=\"fas fa-chevron-down\"></i>\\n          </div>\\n        </div>\\n      </div>\\n\\n      \\x3c!-- 内容区域（移除了点击收缩） --\\x3e\\n      <div class=\"ins-content-area lyrics-box\">\\n        <div v-show=\"!showИгратьlist\" class=\"lyrics-wrapper\">\\n          <div class=\"lyric-line lyric-current current\">{{ currentLine }}</div>\\n          <div class=\"lyric-line lyric-next next\">{{ nextLine }}</div>\\n        </div>\\n\\n        \\x3c!-- Плейлист --\\x3e\\n        <div v-show=\"showИгратьlist\" class=\"playlist-wrapper\" @click.stop @touchstart.stop @touchmove.stop @touchend.stop>\\n          <div class=\"search-bar\">\\n            <i class=\"fas fa-search search-icon\"></i>\\n            <input v-model=\"searchKeyword\" type=\"text\" placeholder=\"Поиск песни...\" @keyup.enter=\"performSearch\" />\\n          </div>\\n          <ul class=\"song-list\">\\n            <li\\n              v-for=\"(song, index) in sharedState.music.list\"\\n              :key=\"index\"\\n              class=\"song-item\"\\n              :class=\"{ \\'is-playing\\': index === sharedState.music.index }\"\\n              @click=\"playFromList(index)\"\\n            >\\n              <div class=\"song-info\">\\n                <span class=\"song-num\">{{ index + 1 }}</span>\\n                <span class=\"song-title\">{{ song.song || song.name || \\'未知歌曲\\' }}</span>\\n              </div>\\n              <span class=\"delete-btn\" @click.stop=\"removeSong(index)\">\\n                <i class=\"fas fa-times\"></i>\\n              </span>\\n            </li>\\n            <li v-if=\"sharedState.music.list.length === 0\" class=\"empty-tip\">Пока нет песен</li>\\n          </ul>\\n        </div>\\n      </div>\\n\\n      <div class=\"ins-actions controls-area\" @click.stop>\\n        <div class=\"left-actions\">\\n          <button\\n            class=\"ins-btn btn-like\"\\n            :class=\"{ \\'is-active\\': isИгратьing }\"\\n            @click=\"e => controlAction(e, !isИгратьing ? \\'play\\' : \\'stop\\')\"\\n          >\\n            <i :class=\"[isИгратьing ? \\'fas fa-heart\\' : \\'far fa-heart\\']\"></i>\\n          </button>\\n          <button class=\"ins-btn\" @click=\"e => controlAction(e, \\'prev\\')\">\\n            <i class=\"fas fa-step-backward\"></i>\\n          </button>\\n          <button class=\"ins-btn\" @click=\"e => controlAction(e, \\'next\\')\">\\n            <i class=\"fas fa-step-forward\"></i>\\n          </button>\\n        </div>\\n        <div class=\"right-actions volume-container\">\\n          <input\\n            v-model=\"volume\"\\n            type=\"range\"\\n            class=\"volume-slider volume-track\"\\n            min=\"0\"\\n            max=\"100\"\\n            :style=\"{ \\'--volume-fill\\': volume + \\'%\\' }\"\\n            @click.stop\\n          />\\n        </div>\\n      </div>\\n\\n      <div class=\"ins-likes\">\\n        <span>Понравилось <b>вам</b></span>\\n      </div>\\n      <div class=\"ins-caption\">\\n        <b>{{ currentSinger }}</b> <span class=\"caption-text\">{{ currentSong }}</span>\\n      </div>\\n    </div>\\n  </div>\\n</template>\\n\\n<script setup lang=\"ts\">\\nimport { onBeforeUnmount, onMounted, ref, watch } from \\'vue\\';\\nimport { sharedState } from \\'./shared-state\\';\\n\\n// 头像逻辑保持不变\\nconst savedAvatar = localStorage.getItem(\\'musicИгратьerAvatar\\');\\nconst defaultAvatar = \\'https://i.pinimg.com/736x/8b/16/7a/8b167af653c2399dd93b952a48740620.jpg\\';\\nconst avatarSrc = ref(savedAvatar || defaultAvatar);\\nconst fileInputRef = ref<HTMLInputElement | null>(null);\\n\\nfunction triggerFileSelect() {\\n  fileInputRef.value?.click();\\n}\\n\\nfunction handleAvatarChange(event: Event) {\\n  const input = event.target as HTMLInputElement;\\n  if (input.files && input.files[0]) {\\n    const reader = new FileReader();\\n    reader.onload = e => {\\n      const result = e.target?.result as string;\\n      if (result) {\\n        avatarSrc.value = result;\\n        localStorage.setItem(\\'musicИгратьerAvatar\\', result);\\n      }\\n    };\\n    reader.readAsDataURL(input.files[0]);\\n  }\\n  input.value = \\'\\';\\n}\\n\\nconst isИгратьing = ref(false);\\nconst volume = ref(65);\\nconst currentLine = ref(\\'Instagram Музыка\\');\\nconst nextLine = ref(`Нажмите для текста`);\\nconst currentSong = ref(``);\\nconst currentSinger = ref(``);\\nconst currentLyricStr = ref(``);\\nconst parsedLyrics = ref<{ time: number; text: string }[]>([]);\\nconst currentLyricIndex = ref(-1);\\nconst hasStarted = ref(false);\\nconst playingIndex = ref(-1);\\nconst showИгратьlist = ref(false);\\nconst searchKeyword = ref(\\'\\');\\n\\nconst musicAudio = new Audio();\\nmusicAudio.volume = volume.value / 100;\\nwatch(volume, newVal => {\\n  musicAudio.volume = newVal / 100;\\n});\\nconst Music = (globalThis as any).Music;\\n\\nwatch(\\n  () => sharedState.music.index,\\n  (newVal, oldVal) => {\\n    if (oldVal == -1 && newVal > -1) {\\n      controlAction(null, \\'play\\');\\n    }\\n  },\\n);\\n\\nfunction toggleViewMode() {\\n  showИгратьlist.value = !showИгратьlist.value;\\n  // 移除了 startHideTimer() 调用\\n}\\n\\n// 【关键修改】Поиск功能：永久保存\\nasync function performSearch() {\\n  const keyword = searchKeyword.value.trim();\\n  if (!keyword) return;\\n\\n  const newSong = {\\n    song: keyword,\\n    name: keyword,\\n    singer: \\'Поиск...\\',\\n    // 标记为手动添加，方便调试，虽然逻辑上已经在 manualList 里了\\n    isManual: true,\\n  };\\n\\n  // 调用 sharedState 的新方法，保存到本地并更新列表\\n  sharedState.music.addManualSong(newSong);\\n\\n  searchKeyword.value = \\'\\';\\n\\n  // Играть刚刚添加的这首歌（列表最后一首）\\n  const newIndex = sharedState.music.list.length - 1;\\n  sharedState.music.index = newIndex;\\n  ИгратьMusic(newIndex);\\n}\\n\\nfunction playFromList(index: number) {\\n  if (index === sharedState.music.index && isИгратьing.value) return;\\n  sharedState.music.index = index;\\n  ИгратьMusic(index);\\n}\\n\\n// 【关键修改】删除功能：调用 sharedState 的方法\\nfunction removeSong(index: number) {\\n  if (index < sharedState.music.index) {\\n    sharedState.music.index--;\\n  } else if (index === sharedState.music.index) {\\n    // 当前歌曲被删除，暂时不自动切歌，防止逻辑混乱，或者вам可以选择停止Играть\\n    // controlAction(null, \\'stop\\');\\n  }\\n\\n  // 统一通过 sharedState 删除（它会判断是聊天记录还是本地记录）\\n  sharedState.music.removeSong(index);\\n}\\n\\nfunction parseLyricToTimeline(lyric: string) {\\n  const lines = lyric.split(/\\\\r?\\\\n/);\\n  const entries: { time: number; text: string }[] = [];\\n  for (const line of lines) {\\n    const timeTags = line.match(/\\\\[(\\\\d{1,2}):(\\\\d{2})(?:\\\\.(\\\\d{1,3}))?\\\\]/g);\\n    const text = line.replace(/\\\\[(\\\\d{1,2}):(\\\\d{2})(?:\\\\.(\\\\d{1,3}))?\\\\]/g, \\'\\').trim();\\n    if (!timeTags || !text) continue;\\n    for (const tag of timeTags) {\\n      const match = tag.match(/\\\\[(\\\\d{1,2}):(\\\\d{2})(?:\\\\.(\\\\d{1,3}))?\\\\]/);\\n      if (!match) continue;\\n      const мин = Number(match[1]);\\n      const сек = Number(match[2]);\\n      const millis = match[3] ? Number(match[3].padEnd(3, \\'0\\')) : 0;\\n      const time = мин * 60 + сек + millis / 1000;\\n      entries.push({ time, text });\\n    }\\n  }\\n  entries.sort((a, b) => a.time - b.time);\\n  return entries;\\n}\\n\\nfunction updateLyricDisplayByTime(currentTime: number) {\\n  const list = parsedLyrics.value;\\n  if (!list.length) {\\n    currentLine.value = \\'\\';\\n    nextLine.value = \\'\\';\\n    currentLyricIndex.value = -1;\\n    return;\\n  }\\n  let idx = list.length - 1;\\n  for (let i = 0; i < list.length; i++) {\\n    if (currentTime < list[i].time) {\\n      idx = i - 1;\\n      break;\\n    }\\n  }\\n  if (idx < 0) {\\n    currentLine.value = \\'\\';\\n    nextLine.value = list[0]?.text ?? \\'\\';\\n    currentLyricIndex.value = -1;\\n    return;\\n  }\\n  if (idx !== currentLyricIndex.value) {\\n    currentLyricIndex.value = idx;\\n    currentLine.value = list[idx]?.text ?? \\'\\';\\n    nextLine.value = list[idx + 1]?.text ?? \\'\\';\\n  }\\n}\\n\\nfunction onTimeUpdate() {\\n  updateLyricDisplayByTime(musicAudio.currentTime || 0);\\n}\\n\\nasync function controlAction(event: any, action: any) {\\n  event?.stopPropagation();\\n  // startHideTimer(); // 【已禁用】防止自动隐藏\\n  if (action == \\'stop\\') {\\n    musicAudio.pause();\\n    isИгратьing.value = false;\\n    return;\\n  }\\n  let index = sharedState.music.index;\\n  if (index == -1 && action !== \\'play\\') return;\\n  if (index == -1 && sharedState.music.list.length > 0) index = 0;\\n\\n  if (index > sharedState.music.list.length - 1) {\\n    index = sharedState.music.list.length - 1;\\n    sharedState.music.index = index;\\n  }\\n\\n  if (action == \\'play\\') {\\n    if (index === -1) return;\\n    const canResume = hasStarted.value && playingIndex.value === index && musicAudio.src;\\n    if (!isИгратьing.value && canResume) {\\n      musicAudio.play();\\n      isИгратьing.value = true;\\n      return;\\n    }\\n    ИгратьMusic(index);\\n  }\\n  if (action == \\'prev\\') {\\n    if (index > 0) index -= 1;\\n    else if (index <= 0) index = sharedState.music.list.length - 1;\\n    sharedState.music.index = index;\\n    ИгратьMusic(index);\\n  }\\n  if (action == \\'next\\') {\\n    if (index >= sharedState.music.list.length - 1) index = 0;\\n    else index += 1;\\n    sharedState.music.index = index;\\n    ИгратьMusic(index);\\n  }\\n}\\n\\nasync function ИгратьMusic(index: number) {\\n  if (!sharedState.music.list[index]) return;\\n\\n  const song = sharedState.music.list[index];\\n  const name = song.song || song.name;\\n  let playUrl = \\'\\';\\n  const cached = sharedState.music.cache[name];\\n  const cachedMeta = cached && typeof cached === \\'object\\' ? cached : null;\\n\\n  if (cached) {\\n    const cachedUrl = typeof cached === \\'string\\' ? cached : cached.Url;\\n    if (cachedUrl) {\\n      const available = await sharedState.music.checkAudioAvailability(cachedUrl);\\n      if (available) {\\n        playUrl = cachedUrl;\\n        if (cachedMeta) {\\n          currentSinger.value = cachedMeta.Singer;\\n          currentSong.value = cachedMeta.Name;\\n          currentLyricStr.value = cachedMeta.Lyric;\\n        }\\n      }\\n    }\\n  }\\n  let fetchedMeta: any = null;\\n  if (!playUrl) {\\n    currentLine.value = \\'Поиск песни中...\\';\\n    nextLine.value = \\'\\';\\n    const result = await Music.SearchMusic(name);\\n    if (!result?.Url) {\\n      currentLine.value = \\'Поиск失败\\';\\n      nextLine.value = \\'请重试\\';\\n      return;\\n    }\\n    playUrl = result.Url;\\n    fetchedMeta = result;\\n    sharedState.music.cache[name] = result;\\n  }\\n  if (playUrl != musicAudio.src) {\\n    musicAudio.src = playUrl;\\n  }\\n  const meta = fetchedMeta || cachedMeta;\\n  if (meta) {\\n    currentSinger.value = meta.Singer;\\n    currentSong.value = meta.Name;\\n    currentLyricStr.value = meta.Lyric;\\n  } else {\\n    currentSinger.value = song.singer || \\'Unknown\\';\\n    currentSong.value = name;\\n  }\\n\\n  if (currentLyricStr.value) {\\n    parsedLyrics.value = parseLyricToTimeline(currentLyricStr.value || \\'\\');\\n    currentLyricIndex.value = -1;\\n    updateLyricDisplayByTime(0);\\n  } else {\\n    parsedLyrics.value = [];\\n    currentLine.value = currentSong.value;\\n    nextLine.value = \\'Текст недоступен\\';\\n  }\\n\\n  musicAudio.play();\\n  isИгратьing.value = true;\\n  hasStarted.value = true;\\n  playingIndex.value = index;\\n}\\n\\nconst widget = ref<HTMLElement | null>(null);\\nlet startX = 0,\\n  startY = 0,\\n  initialX = 0,\\n  initialY = 0;\\nconst dragX = ref(`50%`);\\nconst dragY = ref(`20%`);\\nconst hideTimer: any = null;\\nconst isDragging = ref(false);\\nconst hasMovedWhileDragging = ref(false);\\nconst isRightClick = ref(false);\\nconst windowWidth = $(\\'body\\').width() || 0;\\nconst windowHeight = $(\\'body\\').height() || 0;\\nconst isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\\n\\n// 【关键修改】禁用自动收起\\nfunction startHideTimer() {\\n  clearTimeout(hideTimer);\\n  // 这里把原来的代码逻辑注释掉了，实现“不要手机显隐切换”\\n  /*\\n  const el = widget.value;\\n  if (el && el.classList.contains(\\'expanded\\')) {\\n    hideTimer = setTimeout(() => {\\n      if (!showИгратьlist.value) {\\n        el.classList.remove(\\'expanded\\');\\n        showИгратьlist.value = false;\\n      }\\n    }, 5000);\\n  }\\n  */\\n}\\n// =========================================================\\n//  交互核心逻辑 (请确保这些函数在 script 中只出现一次)\\n// =========================================================\\n\\n// 1. 展开挂件 (给右上角小气泡用)\\nfunction expandWidget() {\\n  const el = widget.value;\\n  if (el) el.classList.add(\\'expanded\\');\\n}\\n\\n// 2. 收起挂件 (给头部收起按钮用)\\nfunction collapseWidget() {\\n  const el = widget.value;\\n  if (el) {\\n    el.classList.remove(\\'expanded\\');\\n    showИгратьlist.value = false;\\n  }\\n}\\n\\n// 3. 拖拽移动逻辑\\nfunction drag(e: any) {\\n  if (!isDragging.value || isRightClick.value) return;\\n\\n  let clientX, clientY;\\n  if (e.type === \\'mousemove\\') {\\n    clientX = e.clientX;\\n    clientY = e.clientY;\\n  } else if (e.type === \\'touchmove\\') {\\n    clientX = e.touches[0].clientX;\\n    clientY = e.touches[0].clientY;\\n  }\\n\\n  const deltaX = clientX - startX;\\n  const deltaY = clientY - startY;\\n\\n  // 计算移动距离\\n  const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\\n\\n  // 防抖阈值：手机端 10px，电脑端 5px\\n  const threshold = e.type === \\'touchmove\\' ? 10 : 5;\\n\\n  if (distance < threshold) {\\n    return; // 移动距离太小，视为手抖/点击，不处理\\n  }\\n\\n  // 确认是拖拽，阻止默认事件\\n  if (e && e.cancelable && typeof e.preventDefault === \\'function\\') {\\n    e.preventDefault();\\n  }\\n\\n  hasMovedWhileDragging.value = true;\\n\\n  const newX = initialX + deltaX;\\n  const newY = initialY + deltaY;\\n  const margin = 20;\\n  const maxX = windowWidth - margin;\\n  const maxY = windowHeight - margin;\\n  const clampedX = Math.max(margin, Math.min(maxX, newX));\\n  const clampedY = Math.max(margin, Math.min(maxY, newY));\\n\\n  if (newX !== clampedX || newY !== clampedY) widget.value!.classList.add(\\'near-boundary\\');\\n  else widget.value!.classList.remove(\\'near-boundary\\');\\n\\n  dragX.value = `${newX}px`;\\n  dragY.value = `${newY}px`;\\n}\\n\\n// 4. 停止拖拽逻辑\\nfunction stopDrag(e: any) {\\n  if (!isDragging.value && !isRightClick.value) return;\\n\\n  // 移除监听\\n  $(\\'body\\').off(\\'mousemove\\', drag);\\n  $(\\'body\\').off(\\'mouseup\\', stopDrag);\\n  $(\\'body\\').off(\\'touchmove\\', drag);\\n  $(\\'body\\').off(\\'touchend\\', stopDrag);\\n\\n  const el = widget.value;\\n  isDragging.value = false;\\n  el && el.classList.remove(\\'dragging\\', \\'near-boundary\\');\\n\\n  if (hasMovedWhileDragging.value) {\\n    savePosition(); // 只有真正拖动了才保存位置\\n  }\\n\\n  hasMovedWhileDragging.value = false;\\n}\\n\\n// 5. 开始拖拽 (绑定在头像区域)\\nfunction startDrag(e: any) {\\n  const el = widget.value;\\n  if (!el) return;\\n\\n  if (e.button === 2 || e.which === 3) {\\n    isRightClick.value = true;\\n    return;\\n  }\\n\\n  // 【关键】点这些地方不要拖拽\\n  if (\\n    e.target.closest(\\'.expand-badge-btn\\') || // 右上角展开气泡 -> 走 expandWidget\\n    e.target.closest(\\'.ins-actions\\') ||\\n    e.target.closest(\\'.playlist-wrapper\\') ||\\n    e.target.closest(\\'.header-actions\\') || // 头部收起按钮 -> 走 collapseWidget\\n    e.target.closest(\\'.ins-avatar-small\\')\\n  ) {\\n    return;\\n  }\\n\\n  isRightClick.value = false;\\n  isDragging.value = true;\\n  hasMovedWhileDragging.value = false;\\n  el.classList.add(\\'dragging\\');\\n\\n  const rect = el.getBoundingClientRect();\\n  initialX = rect.left + rect.width / 2;\\n  initialY = rect.top + rect.height / 2;\\n\\n  if (e.type === \\'mousedown\\') {\\n    startX = e.clientX;\\n    startY = e.clientY;\\n    $(\\'body\\').on(\\'mousemove\\', drag);\\n    $(\\'body\\').on(\\'mouseup\\', stopDrag);\\n  } else if (e.type === \\'touchstart\\') {\\n    startX = e.touches[0].clientX;\\n    startY = e.touches[0].clientY;\\n    $(\\'body\\').on(\\'touchmove\\', drag);\\n    $(\\'body\\').on(\\'touchend\\', stopDrag);\\n  }\\n}\\n\\n// 原来的 toggleExpand 函数可以删掉了，用上面的 expandWidget/collapseWidget 代替\\n\\nfunction savePosition() {\\n  const el = widget.value;\\n  if (!el) return;\\n  const rect = el.getBoundingClientRect();\\n  const position = {\\n    x: ((rect.left + rect.width / 2) / windowWidth) * 100,\\n    y: ((rect.top + rect.height / 2) / windowHeight) * 100,\\n  };\\n  localStorage.setItem(\\'lyricsWidgetPosition\\', JSON.stringify(position));\\n}\\n\\nfunction restorePosition() {\\n  const el = widget.value;\\n  if (!el) return;\\n  const saved = localStorage.getItem(\\'lyricsWidgetPosition\\');\\n  if (saved) {\\n    const position = JSON.parse(saved);\\n    let x = `50`,\\n      y = `20`;\\n    if (position.x < 100 && position.x > 0) x = position.x;\\n    if (position.y < 100 && position.y > 0) y = position.y;\\n    el.style.left = x + \\'%\\';\\n    el.style.top = y + \\'%\\';\\n  }\\n}\\n\\nfunction toggleExpand(event: any) {\\n  const el = widget.value;\\n  if (!el) return;\\n  if (isDragging.value || hasMovedWhileDragging.value || isRightClick.value) return;\\n  if (event && event.target && (event.target.closest(\\'.ins-actions\\') || event.target.closest(\\'.playlist-wrapper\\')))\\n    return;\\n\\n  if (event && (event.button === 2 || event.which === 3)) return;\\n\\n  // 简单的 class 切换，不再依赖 timer 自动关闭\\n  if (el.classList.contains(\\'expanded\\')) {\\n    el.classList.remove(\\'expanded\\');\\n    showИгратьlist.value = false; // 收起时重置回歌词\\n  } else {\\n    el.classList.add(\\'expanded\\');\\n  }\\n\\n  // startHideTimer();\\n}\\n\\nfunction onContextMenu(e: any) {\\n  isRightClick.value = true;\\n  if (isDragging.value) {\\n    isDragging.value = false;\\n    widget.value?.classList.remove(\\'dragging\\', \\'near-boundary\\');\\n  }\\n}\\n\\nfunction onMouseEnter() {\\n  // if (!isMobile && widget.value?.classList.contains(\\'expanded\\')) clearTimeout(hideTimer);\\n}\\n\\nfunction onMouseLeave() {\\n  // if (!isMobile && widget.value?.classList.contains(\\'expanded\\') && !isDragging.value && !showИгратьlist.value) {\\n  // hideTimer = setTimeout(() => widget.value?.classList.remove(\\'expanded\\'), 2000);\\n  // }\\n}\\n\\nfunction onTouchEnd() {\\n  // if (isMobile && widget.value?.classList.contains(\\'expanded\\') && !isDragging.value) {\\n  // clearTimeout(hideTimer);\\n  // hideTimer = setTimeout(() => startHideTimer(), 100);\\n  // }\\n}\\n\\nfunction onResize() {\\n  const el = widget.value;\\n  if (!el) return;\\n  const rect = el.getBoundingClientRect();\\n  const newX = Math.max(50, Math.min(windowWidth - 50, rect.left + rect.width / 2));\\n  const newY = Math.max(50, Math.min(windowHeight - 50, rect.top + rect.height / 2));\\n  el.style.left = (newX / windowWidth) * 100 + \\'%\\';\\n  el.style.top = (newY / windowHeight) * 100 + \\'%\\';\\n  savePosition();\\n}\\n\\nfunction onVisibilityChange() {\\n  // if (document.hidden) clearTimeout(hideTimer);\\n  // else if (widget.value?.classList.contains(\\'expanded\\')) startHideTimer();\\n}\\n\\nfunction onDocumentClick(e: any) {\\n  if (isRightClick.value && !e.target?.closest?.(\\'.lyrics-widget\\')) isRightClick.value = false;\\n}\\n\\nfunction onKeyDown(e: any) {\\n  if (e.key === \\'Escape\\') isRightClick.value = false;\\n}\\n\\nonMounted(() => {\\n  if (widget.value)\\n    widget.value.addEventListener(\\n      \\'touchmove\\',\\n      e => {\\n        if (isDragging.value) e.preventDefault();\\n      },\\n      { passive: false },\\n    );\\n  $(\\'body\\').on(\\'visibilitychange\\', onVisibilityChange);\\n  $(\\'body\\').on(\\'click\\', onDocumentClick);\\n  $(\\'body\\').on(\\'keydown\\', onKeyDown);\\n  window.addEventListener(\\'resize\\', onResize);\\n  restorePosition();\\n  musicAudio.addEventListener(\\'timeupdate\\', onTimeUpdate);\\n\\n  // 初始加载时，合并一下列表\\n  sharedState.music.updateFullList();\\n});\\n\\nonBeforeUnmount(() => {\\n  // clearTimeout(hideTimer);\\n  $(\\'body\\').off(\\'mousemove\\', drag);\\n  $(\\'body\\').off(\\'mouseup\\', stopDrag);\\n  $(\\'body\\').off(\\'touchmove\\', drag);\\n  $(\\'body\\').off(\\'touchend\\', stopDrag);\\n  $(\\'body\\').off(\\'visibilitychange\\', onVisibilityChange);\\n  $(\\'body\\').off(\\'click\\', onDocumentClick);\\n  $(\\'body\\').off(\\'keydown\\', onKeyDown);\\n  window.removeEventListener(\\'resize\\', onResize);\\n  musicAudio.removeEventListener(\\'timeupdate\\', onTimeUpdate);\\n});\\n<\\/script>\\n<style scoped>\\n@import url(\\'https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap\\');\\n\\n/* --- 核心容器：收缩状态 --- */\\n.lyrics-widget {\\n  position: absolute;\\n  top: 20%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  width: 58px;\\n  height: 58px;\\n  border-radius: 50%;\\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\\n  user-select: none;\\n  background: transparent;\\n  transition:\\n    width 0.3s cubic-bezier(0.2, 0.8, 0.2, 1),\\n    height 0.3s cubic-bezier(0.2, 0.8, 0.2, 1),\\n    border-radius 0.3s ease,\\n    background 0.3s ease;\\n  cursor: pointer;\\n  z-index: 9999999;\\n  overflow: hidden;\\n  font-family: -apple-system, BlinkMacSystemFont, \\'Segoe UI\\', Roboto, Helvetica, Arial, sans-serif;\\n  color: #262626;\\n}\\n\\n/* Ins Story 彩虹圈 */\\n.story-ring {\\n  position: absolute;\\n  inset: 0;\\n  border-radius: 50%;\\n  padding: 2px;\\n  background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);\\n  -webkit-mask:\\n    linear-gradient(#fff 0 0) content-box,\\n    linear-gradient(#fff 0 0);\\n  -webkit-mask-composite: xor;\\n  mask-composite: exclude;\\n  transition: opacity 0.2s;\\n  pointer-events: none;\\n}\\n\\n/* 收缩时的头像容器 */\\n.avatar-collapsed {\\n  position: absolute;\\n  inset: 5px;\\n  border-radius: 50%;\\n  background: #fafafa;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  overflow: hidden; /* 防止图片溢出 */\\n  transition: opacity 0.2s;\\n}\\n\\n/* 悬浮球头像图片 */\\n.avatar-img {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  /* --- 新增以下防止误触的代码 --- */\\n  user-select: none; /* 禁止选中 */\\n  -webkit-user-drag: none; /* 禁止浏览器默认的拖拽行为 (Chrome/Safari) */\\n  pointer-events: none; /* 让点击穿透图片，直接点在后面的 div 上 */\\n}\\n\\n/* --- 展开状态：Ins Post --- */\\n.lyrics-widget.expanded {\\n  width: 330px;\\n  height: auto;\\n  min-height: 400px;\\n  background: #ffffff;\\n  border-radius: 8px;\\n  border: 1px solid #dbdbdb;\\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);\\n  cursor: default;\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.lyrics-widget.expanded .story-ring,\\n.lyrics-widget.expanded .avatar-collapsed {\\n  opacity: 0;\\n  pointer-events: none;\\n}\\n\\n.lyrics-widget.dragging {\\n  cursor: grabbing;\\n  transform: translate(-50%, -50%) scale(1.02);\\n  transition: none;\\n}\\n\\n/* --- 内部内容布局 --- */\\n.content {\\n  display: flex;\\n  flex-direction: column;\\n  height: 100%;\\n  opacity: 0;\\n  pointer-events: none;\\n  transition: opacity 0.1s ease;\\n}\\n\\n.lyrics-widget.expanded .content {\\n  opacity: 1;\\n  pointer-events: auto;\\n  transition: opacity 0.3s ease 0.1s;\\n}\\n\\n/* 1. Header */\\n.ins-header {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 14px 16px;\\n  border-bottom: 1px solid #efefef;\\n  height: 60px;\\n  box-sizing: border-box;\\n}\\n\\n.ins-avatar-group {\\n  display: flex;\\n  align-items: center;\\n  gap: 10px;\\n  overflow: hidden;\\n}\\n\\n.ins-avatar-small {\\n  width: 32px;\\n  height: 32px;\\n  border-radius: 50%;\\n  overflow: hidden;\\n  flex-shrink: 0;\\n}\\n\\n/* Header 小头像图片 */\\n.avatar-img-small {\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n}\\n\\n.ins-meta {\\n  display: flex;\\n  flex-direction: column;\\n  overflow: hidden;\\n}\\n\\n.ins-username {\\n  font-size: 14px;\\n  font-weight: 600;\\n  color: #262626;\\n  line-height: 18px;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n.ins-location {\\n  font-size: 12px;\\n  color: #262626;\\n  line-height: 14px;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n}\\n\\n.ins-more {\\n  color: #262626;\\n  padding-left: 10px;\\n  cursor: pointer;\\n  font-size: 14px;\\n}\\n\\n/* 2. Content Area (歌词 / 列表) */\\n.ins-content-area {\\n  width: 100%;\\n  min-height: 250px;\\n  background: #fafafa;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  position: relative;\\n  overflow: hidden;\\n  border-bottom: 1px solid #efefef;\\n  flex: 1; /* 填充剩余空间 */\\n}\\n\\n/* 歌词视图 */\\n.lyrics-wrapper {\\n  padding: 20px;\\n  text-align: center;\\n  width: 100%;\\n}\\n\\n.lyric-line {\\n  transition: all 0.4s ease;\\n  font-family: -apple-system, BlinkMacSystemFont, \\'Segoe UI\\', Roboto, sans-serif;\\n  margin: 6px 0;\\n}\\n\\n.lyric-line.current {\\n  font-size: 20px;\\n  font-weight: 600;\\n  color: #262626;\\n  line-height: 1.4;\\n}\\n\\n.lyric-line.next {\\n  font-size: 14px;\\n  color: #8e8e8e;\\n}\\n\\n/* --- 新增：列表与Поиск视图样式 --- */\\n.playlist-wrapper {\\n  width: 100%;\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  background: #fff;\\n}\\n\\n.search-bar {\\n  padding: 10px 15px;\\n  border-bottom: 1px solid #efefef;\\n  display: flex;\\n  align-items: center;\\n  background: #fafafa;\\n}\\n\\n.search-icon {\\n  color: #8e8e8e;\\n  font-size: 12px;\\n  margin-right: 8px;\\n}\\n\\n.search-bar input {\\n  border: none;\\n  background: transparent;\\n  width: 100%;\\n  font-size: 14px;\\n  outline: none;\\n  color: #262626;\\n}\\n\\n.song-list {\\n  flex: 1;\\n  overflow-y: auto;\\n  list-style: none;\\n  padding: 0;\\n  margin: 0;\\n}\\n\\n.song-item {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  padding: 10px 15px;\\n  border-bottom: 1px solid #f0f0f0;\\n  cursor: pointer;\\n  transition: background 0.1s;\\n}\\n\\n.song-item:hover {\\n  background: #fafafa;\\n}\\n\\n.song-item.is-playing {\\n  background: #f0f8ff;\\n  border-left: 3px solid #0095f6; /* Instagram Blue */\\n}\\n\\n.song-info {\\n  display: flex;\\n  align-items: center;\\n  overflow: hidden;\\n  flex: 1;\\n}\\n\\n.song-num {\\n  font-size: 12px;\\n  color: #8e8e8e;\\n  width: 24px;\\n  flex-shrink: 0;\\n}\\n\\n.song-title {\\n  font-size: 14px;\\n  color: #262626;\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  margin-right: 10px;\\n}\\n\\n.is-playing .song-title {\\n  font-weight: 600;\\n  color: #0095f6;\\n}\\n\\n.delete-btn {\\n  color: #c7c7c7;\\n  padding: 5px;\\n  font-size: 12px;\\n}\\n.delete-btn:hover {\\n  color: #ed4956;\\n}\\n\\n.empty-tip {\\n  padding: 20px;\\n  text-align: center;\\n  color: #8e8e8e;\\n  font-size: 13px;\\n}\\n\\n/* 3. Actions Footer */\\n.ins-actions {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 12px 16px;\\n  height: 54px;\\n  box-sizing: border-box;\\n}\\n\\n.left-actions {\\n  display: flex;\\n  align-items: center;\\n  gap: 16px;\\n}\\n\\n.ins-btn {\\n  background: none;\\n  border: none;\\n  padding: 0;\\n  cursor: pointer;\\n  color: #262626;\\n  transition: transform 0.1s;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.ins-btn i {\\n  font-size: 24px;\\n}\\n\\n.ins-btn:hover {\\n  opacity: 0.7;\\n}\\n\\n.ins-btn:active {\\n  transform: scale(0.9);\\n}\\n\\n.btn-like.is-active i {\\n  color: #ed4956;\\n  animation: heart-beat 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);\\n}\\n\\n@keyframes heart-beat {\\n  0% {\\n    transform: scale(1);\\n  }\\n  50% {\\n    transform: scale(1.3);\\n  }\\n  100% {\\n    transform: scale(1);\\n  }\\n}\\n\\n.right-actions {\\n  width: 80px;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n/* 4. Likes & Caption */\\n.ins-likes,\\n.ins-caption {\\n  padding: 0 16px;\\n  font-size: 14px;\\n  color: #262626;\\n  line-height: 18px;\\n  margin-bottom: 6px;\\n}\\n\\n.ins-likes {\\n  margin-bottom: 8px;\\n}\\n\\n.ins-likes b,\\n.ins-caption b {\\n  font-weight: 600;\\n}\\n\\n.ins-caption {\\n  margin-bottom: 16px;\\n}\\n\\n.caption-text {\\n  font-weight: 400;\\n}\\n\\n/* --- Громкость条 (强制重置) --- */\\n.volume-slider {\\n  -webkit-appearance: none !important;\\n  appearance: none !important;\\n  background: transparent !important;\\n  filter: none !important;\\n  border: none !important;\\n  border-radius: 0 !important;\\n  box-shadow: none !important;\\n  margin: 0 !important;\\n  padding: 0 !important;\\n  width: 100% !important;\\n  height: 100% !important;\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer !important;\\n}\\n\\n.volume-slider::-webkit-slider-runnable-track {\\n  width: 100%;\\n  height: 2px;\\n  border: none;\\n  background-image: linear-gradient(\\n    90deg,\\n    #262626 0%,\\n    #262626 var(--volume-fill, 0%),\\n    #dbdbdb var(--volume-fill, 0%),\\n    #dbdbdb 100%\\n  );\\n  background-size: 100% 100% !important;\\n  background-repeat: no-repeat;\\n  -webkit-appearance: none !important;\\n}\\n\\n.volume-slider::-webkit-slider-thumb {\\n  -webkit-appearance: none !important;\\n  appearance: none !important;\\n  height: 10px !important;\\n  width: 10px !important;\\n  border-radius: 50% !important;\\n  background: #262626 !important;\\n  margin-top: -4px !important;\\n  border: none !important;\\n  box-shadow: none !important;\\n}\\n\\n.volume-slider::-moz-range-track {\\n  width: 100%;\\n  height: 2px;\\n  border: none !important;\\n  background-image: linear-gradient(\\n    90deg,\\n    #262626 0%,\\n    #262626 var(--volume-fill, 0%),\\n    #dbdbdb var(--volume-fill, 0%),\\n    #dbdbdb 100%\\n  );\\n}\\n.volume-slider::-moz-range-thumb {\\n  height: 10px !important;\\n  width: 10px !important;\\n  border: none !important;\\n  border-radius: 50% !important;\\n  background: #262626 !important;\\n}\\n\\n.lyrics-widget.near-boundary {\\n  box-shadow: 0 0 0 2px #ed4956;\\n}\\n\\n@media (max-width: 480px) {\\n  .lyrics-widget.expanded {\\n    width: 90%;\\n    max-width: 350px;\\n  }\\n}\\n/* --- 新增：收缩态时的展开遮罩 --- */\\n.avatar-collapsed {\\n  /* 保持原有样式 */\\n  position: absolute;\\n  inset: 5px;\\n  border-radius: 50%;\\n  background: #fafafa;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  overflow: hidden;\\n  /* 关键：让这个容器能响应点击 */\\n  cursor: pointer;\\n}\\n\\n/* 展开按钮遮罩层 */\\n.expand-overlay {\\n  position: absolute;\\n  inset: 0;\\n  background: rgba(0, 0, 0, 0.3); /* 微微的黑底 */\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  opacity: 0;\\n  transition: opacity 0.2s;\\n  z-index: 10;\\n}\\n\\n/* 在手机端或者鼠标悬停时显示这个遮罩 */\\n.lyrics-widget:hover .expand-overlay,\\n.expand-overlay {\\n  /* 如果觉得一直显示图标太挡脸，可以把 .expand-overlay 的 opacity 设为 0，\\n      然后只保留 :hover，但在手机上最好给一点提示，或者稍微调低透明度 */\\n  opacity: 1;\\n  background: rgba(0, 0, 0, 0.1); /* 手机上淡一点 */\\n}\\n\\n.expand-overlay i {\\n  color: white;\\n  font-size: 20px;\\n  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);\\n}\\n\\n/* --- 修改：头部布局 --- */\\n.ins-header {\\n  /* 保持原有 flex */\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 14px 16px;\\n  border-bottom: 1px solid #efefef;\\n  height: 60px;\\n}\\n\\n.header-actions {\\n  display: flex;\\n  align-items: center;\\n  gap: 15px;\\n}\\n\\n.ins-icon-btn {\\n  color: #262626;\\n  cursor: pointer;\\n  font-size: 16px;\\n  padding: 5px; /* 增加点击区域 */\\n  transition: transform 0.1s;\\n}\\n\\n.ins-icon-btn:active {\\n  transform: scale(0.9);\\n}\\n\\n.close-btn {\\n  color: #8e8e8e;\\n}\\n.close-btn:hover {\\n  color: #262626;\\n}\\n\\n/* --- 修复：内容区域移除点击手型 --- */\\n.ins-content-area {\\n  cursor: default; /* 不再显示手型，暗示不能点击收缩 */\\n}\\n/* --- 核心容器 --- */\\n/* 保持原有 lyrics-widget 样式，但不需要 overflow: hidden，否则小气泡会被切掉 */\\n.lyrics-widget {\\n  /* ...原有样式... */\\n  /* 修改：只要去掉 overflow: hidden 即可，其他 keeping */\\n  overflow: visible;\\n}\\n\\n/* --- 小气泡展开按钮 (Ins 风格) --- */\\n.expand-badge-btn {\\n  position: absolute;\\n  top: -2px; /* 稍微超出一点点，营造悬浮感 */\\n  right: -2px;\\n  width: 24px;\\n  height: 24px;\\n  background: #fff;\\n  border-radius: 50%;\\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  cursor: pointer;\\n  z-index: 20; /* 必须比头像高 */\\n  transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);\\n}\\n\\n.expand-badge-btn i {\\n  font-size: 12px;\\n  background: -webkit-linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);\\n  -webkit-background-clip: text;\\n  -webkit-text-fill-color: transparent;\\n  /* 如果不支持渐变字体，回退颜色 */\\n  color: #cc2366;\\n}\\n\\n/* 交互动画 */\\n.expand-badge-btn:hover {\\n  transform: scale(1.15);\\n}\\n\\n.expand-badge-btn:active {\\n  transform: scale(0.9);\\n}\\n\\n/* 展开后隐藏这个小按钮 */\\n.lyrics-widget.expanded .expand-badge-btn {\\n  opacity: 0;\\n  pointer-events: none;\\n  transform: scale(0);\\n}\\n\\n/* --- 修复头像层 --- */\\n.avatar-collapsed {\\n  /* ...原有样式... */\\n  /* 确保头像层不会盖住小按钮 */\\n  z-index: 1;\\n  /* 拖拽主要靠这里 */\\n  cursor: grab;\\n}\\n\\n.lyrics-widget.dragging .avatar-collapsed {\\n  cursor: grabbing;\\n}\\n\\n/* --- 头部样式微调 (保持之前的) --- */\\n.header-actions {\\n  display: flex;\\n  align-items: center;\\n  gap: 12px;\\n}\\n.ins-icon-btn {\\n  padding: 8px;\\n  cursor: pointer;\\n  color: #262626;\\n  font-size: 16px;\\n}\\n/* --- 毛玻璃展开气泡 (Glassmorphism Badge) --- */\\n.expand-badge-btn {\\n  /* 定位：悬浮在头像右上角 */\\n  position: absolute;\\n  top: 0px; /* 紧贴边缘 */\\n  right: 0px; /* 紧贴边缘 */\\n\\n  /* 尺寸：小巧精致 */\\n  width: 24px;\\n  height: 24px;\\n  border-radius: 50%;\\n\\n  /* --- 毛玻璃特效核心 --- */\\n  background: rgba(255, 255, 255, 0.4); /* 半透明白色底 */\\n  backdrop-filter: blur(8px); /* 背景模糊 */\\n  -webkit-backdrop-filter: blur(8px); /* Safari 兼容 */\\n  border: 1px solid rgba(255, 255, 255, 0.6); /* 淡淡的白边，增加立体感 */\\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); /* 柔和的投影 */\\n\\n  /* 布局 */\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  cursor: pointer;\\n  z-index: 20;\\n  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\\n}\\n\\n/* 图标颜色 */\\n.expand-badge-btn i {\\n  font-size: 11px;\\n  /* 使用深灰色或者黑色，在毛玻璃上对比度更好，更像原生iOS组件 */\\n  color: #333;\\n  /* 如果вам还是想要渐变色图标，保留下面这两行，否则删掉用上面的纯色 */\\n  /* background: -webkit-linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); */\\n  /* -webkit-background-clip: text; */\\n  /* -webkit-text-fill-color: transparent; */\\n}\\n\\n/* 悬停交互：变亮一点，稍微放大 */\\n.expand-badge-btn:hover {\\n  background: rgba(255, 255, 255, 0.65);\\n  transform: scale(1.1);\\n  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);\\n}\\n\\n/* 点击时的反馈 */\\n.expand-badge-btn:active {\\n  transform: scale(0.9);\\n}\\n\\n/* 展开后隐藏 */\\n.lyrics-widget.expanded .expand-badge-btn {\\n  opacity: 0;\\n  pointer-events: none;\\n  transform: scale(0);\\n  transition:\\n    transform 0.2s,\\n    opacity 0.2s;\\n}\\n</style>\\n'],sourceRoot:''}]);const r=s},314:n=>{n.exports=function(n){var e=n[1],t=n[3];if(!t)return e;if('function'==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),i='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(a),o='/*# '.concat(i,' */');return[e].concat([o]).join('\\n')}return[e].join('\\n')}},378:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map(function(e){var t='',a=void 0!==e[5];return e[4]&&(t+='@supports ('.concat(e[4],') {')),e[2]&&(t+='@media '.concat(e[2],' {')),a&&(t+='@layer'.concat(e[5].length>0?' '.concat(e[5]):'',' {')),t+=n(e),a&&(t+='}'),e[2]&&(t+='}'),e[4]&&(t+='}'),t}).join('')},e.i=function(n,t,a,i,o){'string'==typeof n&&(n=[[null,n,void 0]]);var s={};if(a)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(s[l]=!0)}for(var c=0;c<n.length;c++){var d=[].concat(n[c]);a&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]='@layer'.concat(d[5].length>0?' '.concat(d[5]):'',' {').concat(d[1],'}')),d[5]=o),t&&(d[2]?(d[1]='@media '.concat(d[2],' {').concat(d[1],'}'),d[2]=t):d[2]=t),i&&(d[4]?(d[1]='@supports ('.concat(d[4],') {').concat(d[1],'}'),d[4]=i):d[4]=''.concat(i)),e.push(d))}},e}},400:(n,e)=>{e.A=(n,e)=>{const t=n.__vccOpts||n;for(const[n,a]of e)t[n]=a;return t}},424:(n,e,t)=>{function a(n,e){for(var t=[],a={},i=0;i<e.length;i++){var o=e[i],s=o[0],r={id:n+':'+i,css:o[1],media:o[2],sourceMap:o[3]};a[s]?a[s].parts.push(r):t.push(a[s]={id:s,parts:[r]})}return t}t.d(e,{A:()=>C});var i='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!i)throw new Ошибка('vue-style-loader cannot be used in a non-browser environment. Use { target: \\'node\\' } in вамr Webpack config to indicate a server-rendering environment.');var o={},s=i&&(document.head||document.getElementsByTagName('head')[0]),r=null,l=0,c=!1,d=function(){},A=null,u='data-vue-ssr-id',p='undefined'!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function C(n,e,t,i){c=t,A=i||{};var s=a(n,e);return f(s),function(e){for(var t=[],i=0;i<s.length;i++){var r=s[i];(l=o[r.id]).refs--,t.push(l)}e?f(s=a(n,e)):s=[];for(i=0;i<t.length;i++){var l;if(0===(l=t[i]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete o[l.id]}}}}function f(n){for(var e=0;e<n.length;e++){var t=n[e],a=o[t.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](t.parts[i]);for(;i<t.parts.length;i++)a.parts.push(m(t.parts[i]));a.parts.length>t.parts.length&&(a.parts.length=t.parts.length)}else{var s=[];for(i=0;i<t.parts.length;i++)s.push(m(t.parts[i]));o[t.id]={id:t.id,refs:1,parts:s}}}}function g(){var n=document.createElement('style');return n.type='text/css',s.appendChild(n),n}function m(n){var e,t,a=document.querySelector('style['+u+'~=\"'+n.id+'\"]');if(a){if(c)return d;a.parentNode.removeChild(a)}if(p){var i=l++;a=r||(r=g()),e=b.bind(null,a,i,!1),t=b.bind(null,a,i,!0)}else a=g(),e=x.bind(null,a),t=function(){a.parentNode.removeChild(a)};return e(n),function(a){if(a){if(a.css===n.css&&a.media===n.media&&a.sourceMap===n.sourceMap)return;e(n=a)}else t()}}var v,h=(v=[],function(n,e){return v[n]=e,v.filter(Boolean).join('\\n')});function b(n,e,t,a){var i=t?'':a.css;if(n.styleSheet)n.styleSheet.cssText=h(e,i);else{var o=document.createTextNode(i),s=n.childNodes;s[e]&&n.removeChild(s[e]),s.length?n.insertBefore(o,s[e]):n.appendChild(o)}}function x(n,e){var t=e.css,a=e.media,i=e.sourceMap;if(a&&n.setAttribute('media',a),A.ssrId&&n.setAttribute(u,e.id),i&&(t+='\\n/*# sourceURL='+i.sources[0]+' */',t+='\\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+' */'),n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}}},e={};function t(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={id:a,exports:{}};return n[a](o,o.exports,t),o.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var a in e)t.o(e,a)&&!t.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:e[a]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.r=n=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(n,'__esModule',{value:!0})};const a=Vue,i=JSON.parse(localStorage.getItem('musicИгратьer_manualList')||'[]'),o=(0,a.reactive)({music:{cache:{},regex: /<bgm>текущая музыка[:：](.+?) - (.+?)<\\/bgm>/g,chatList:[],manualList:i,index:-1,autoИгратьer:!1,updateFullList(){this.list=[...this.chatList,...this.manualList]},addManualSong(n){this.manualList.push(n),this.saveManualList(),this.updateFullList()},removeSong(n){if(n<this.chatList.length)this.chatList.splice(n,1);else{const e=n-this.chatList.length;this.manualList.splice(e,1),this.saveManualList()}this.updateFullList()},saveManualList(){localStorage.setItem('musicИгратьer_manualList',JSON.stringify(this.manualList))},async getAllChatMessages(){const n=await triggerSlash('/pass {{lastMessageId}}');if(!n)return;const e=[],t=await getChatMessages(`0-${n}`,{role:'all'});for(const n of t){const t=[...n.message.matchAll(this.regex)];if(0==t.length)continue;const a=t.at(-1),i={song:a[1],singer:a[2],message_id:n.message_id};e.push(i)}this.chatList=e,this.updateFullList(),console.log('Плейлист更新:',this.list),-1===this.index&&this.list.length>0&&(this.index=this.list.length-1)},checkAudioAvailability:async n=>new Promise(e=>{const t=new Audio;let a;const i=()=>{s(),e(!0)},o=()=>{s(),e(!1)},s=()=>{t.removeEventListener('loadedmetadata',i),t.removeEventListener('error',o),clearTimeout(a),t.src=''};t.preload='metadata',t.src=n,a=setTimeout(o,3e3),t.addEventListener('loadedmetadata',i),t.addEventListener('error',o)})}}),s={class:'avatar-collapsed'},r=['src'],l={class:'content'},c={class:'ins-header'},d={class:'ins-avatar-group'},A=['src'],u={class:'ins-meta'},p={class:'ins-username'},C={class:'ins-location'},f={class:'header-actions'},g={class:'ins-content-area lyrics-box'},m={class:'lyrics-wrapper'},v={class:'lyric-line lyric-current current'},h={class:'lyric-line lyric-next next'},b={class:'search-bar'},x={class:'song-list'},y=['onClick'],B={class:'song-info'},w={class:'song-num'},k={class:'song-title'},E=['onClick'],S={key:0,class:'empty-tip'},M={class:'left-actions'},L={class:'right-actions volume-container'},F={class:'ins-caption'},N={class:'caption-text'},V=(0,a.defineComponent)({__name:'musicИгратьer',setup(n){const e=localStorage.getItem('musicИгратьerAvatar'),t=(0,a.ref)(e||'https://i.pinimg.com/736x/8b/16/7a/8b167af653c2399dd93b952a48740620.jpg'),i=(0,a.ref)(null);function V(){i.value?.click()}function Y(n){const e=n.target;if(e.files&&e.files[0]){const n=new FileReader;n.onload=n=>{const e=n.target?.result;e&&(t.value=e,localStorage.setItem('musicИгратьerAvatar',e))},n.readAsDataURL(e.files[0])}e.value=''}const D=(0,a.ref)(!1),U=(0,a.ref)(65),T=(0,a.ref)('Instagram Музыка'),W=(0,a.ref)('Нажмите для текста'),P=(0,a.ref)(''),I=(0,a.ref)(''),X=(0,a.ref)(''),j=(0,a.ref)([]),G=(0,a.ref)(-1),R=(0,a.ref)(!1),O=(0,a.ref)(-1),q=(0,a.ref)(!1),H=(0,a.ref)(''),Z=new Audio;Z.volume=U.value/100,(0,a.watch)(U,n=>{Z.volume=n/100});const K=globalThis.Music;function Q(){q.value=!q.value}async function J(){const n=H.value.trim();if(!n)return;const e={song:n,name:n,singer:'Поиск...',isManual:!0};o.music.addManualSong(e),H.value='';const t=o.music.list.length-1;o.music.index=t,an(t)}function nn(n){const e=j.value;if(!e.length)return T.value='',W.value='',void(G.value=-1);let t=e.length-1;for(let a=0;a<e.length;a++)if(n<e[a].time){t=a-1;break}if(t<0)return T.value='',W.value=e[0]?.text??'',void(G.value=-1);t!==G.value&&(G.value=t,T.value=e[t]?.text??'',W.value=e[t+1]?.text??'')}function en(){nn(Z.currentTime||0)}async function tn(n,e){if(n?.stopPropagation(),'stop'==e)return Z.pause(),void(D.value=!1);let t=o.music.index;if(-1!=t||'play'===e){if(-1==t&&o.music.list.length>0&&(t=0),t>o.music.list.length-1&&(t=o.music.list.length-1,o.music.index=t),'play'==e){if(-1===t)return;const n=R.value&&O.value===t&&Z.src;if(!D.value&&n)return Z.play(),void(D.value=!0);an(t)}'prev'==e&&(t>0?t-=1:t<=0&&(t=o.music.list.length-1),o.music.index=t,an(t)),'next'==e&&(t>=o.music.list.length-1?t=0:t+=1,o.music.index=t,an(t))}}async function an(n){if(!o.music.list[n])return;const e=o.music.list[n],t=e.song||e.name;let a='';const i=o.music.cache[t],s=i&&'object'==typeof i?i:null;if(i){const n='string'==typeof i?i:i.Url;if(n){await o.music.checkAudioAvailability(n)&&(a=n,s&&(I.value=s.Singer,P.value=s.Name,X.value=s.Lyric))}}let r=null;if(!a){T.value='Поиск песни中...',W.value='';const n=await K.SearchMusic(t);if(!n?.Url)return T.value='Поиск失败',void(W.value='请重试');a=n.Url,r=n,o.music.cache[t]=n}a!=Z.src&&(Z.src=a);const l=r||s;l?(I.value=l.Singer,P.value=l.Name,X.value=l.Lyric):(I.value=e.singer||'Unknown',P.value=t),X.value?(j.value=function(n){const e=n.split(/\\r?\\n/),t=[];for(const n of e){const e=n.match(/\\[(\\d{1,2}):(\\d{2})(?:\\.(\\d{1,3}))?\\]/g),a=n.replace(/\\[(\\d{1,2}):(\\d{2})(?:\\.(\\d{1,3}))?\\]/g,'').trim();if(e&&a)for(const n of e){const e=n.match(/\\[(\\d{1,2}):(\\d{2})(?:\\.(\\d{1,3}))?\\]/);if(!e)continue;const i=60*Number(e[1])+Number(e[2])+(e[3]?Number(e[3].padEnd(3,'0')):0)/1e3;t.push({time:i,text:a})}}return t.sort((n,e)=>n.time-e.time),t}(X.value||''),G.value=-1,nn(0)):(j.value=[],T.value=P.value,W.value='Текст недоступен'),Z.play(),D.value=!0,R.value=!0,O.value=n}(0,a.watch)(()=>o.music.index,(n,e)=>{-1==e&&n>-1&&tn(null,'play')});const on=(0,a.ref)(null);let sn=0,rn=0,ln=0,cn=0;const dn=(0,a.ref)('50%'),An=(0,a.ref)('20%'),un=(0,a.ref)(!1),pn=(0,a.ref)(!1),Cn=(0,a.ref)(!1),fn=$('body').width()||0,gn=$('body').height()||0;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);function mn(){const n=on.value;n&&n.classList.add('expanded')}function vn(){const n=on.value;n&&(n.classList.remove('expanded'),q.value=!1)}function hn(n){if(!un.value||Cn.value)return;let e,t;'mousemove'===n.type?(e=n.clientX,t=n.clientY):'touchmove'===n.type&&(e=n.touches[0].clientX,t=n.touches[0].clientY);const a=e-sn,i=t-rn;if(Math.sqrt(a*a+i*i)<('touchmove'===n.type?10:5))return;n&&n.cancelable&&'function'==typeof n.preventDefault&&n.preventDefault(),pn.value=!0;const o=ln+a,s=cn+i,r=fn-20,l=gn-20,c=Math.max(20,Math.min(r,o)),d=Math.max(20,Math.min(l,s));o!==c||s!==d?on.value.classList.add('near-boundary'):on.value.classList.remove('near-boundary'),dn.value=`${o}px`,An.value=`${s}px`}function bn(n){if(!un.value&&!Cn.value)return;$('body').off('mousemove',hn),$('body').off('mouseup',bn),$('body').off('touchmove',hn),$('body').off('touchend',bn);const e=on.value;un.value=!1,e&&e.classList.remove('dragging','near-boundary'),pn.value&&yn(),pn.value=!1}function xn(n){const e=on.value;if(!e)return;if(2===n.button||3===n.which)return void(Cn.value=!0);if(n.target.closest('.expand-badge-btn')||n.target.closest('.ins-actions')||n.target.closest('.playlist-wrapper')||n.target.closest('.header-actions')||n.target.closest('.ins-avatar-small'))return;Cn.value=!1,un.value=!0,pn.value=!1,e.classList.add('dragging');const t=e.getBoundingClientRect();ln=t.left+t.width/2,cn=t.top+t.height/2,'mousedown'===n.type?(sn=n.clientX,rn=n.clientY,$('body').on('mousemove',hn),$('body').on('mouseup',bn)):'touchstart'===n.type&&(sn=n.touches[0].clientX,rn=n.touches[0].clientY,$('body').on('touchmove',hn),$('body').on('touchend',bn))}function yn(){const n=on.value;if(!n)return;const e=n.getBoundingClientRect(),t={x:(e.left+e.width/2)/fn*100,y:(e.top+e.height/2)/gn*100};localStorage.setItem('lyricsWidgetPosition',JSON.stringify(t))}function Bn(n){Cn.value=!0,un.value&&(un.value=!1,on.value?.classList.remove('dragging','near-boundary'))}function wn(){const n=on.value;if(!n)return;const e=n.getBoundingClientRect(),t=Math.max(50,Math.min(fn-50,e.left+e.width/2)),a=Math.max(50,Math.min(gn-50,e.top+e.height/2));n.style.left=t/fn*100+'%',n.style.top=a/gn*100+'%',yn()}function kn(){}function En(n){Cn.value&&!n.target?.closest?.('.lyrics-widget')&&(Cn.value=!1)}function Sn(n){'Escape'===n.key&&(Cn.value=!1)}return(0,a.onMounted)(()=>{on.value&&on.value.addEventListener('touchmove',n=>{un.value&&n.preventDefault()},{passive:!1}),$('body').on('visibilitychange',kn),$('body').on('click',En),$('body').on('keydown',Sn),window.addEventListener('resize',wn),function(){const n=on.value;if(!n)return;const e=localStorage.getItem('lyricsWidgetPosition');if(e){const t=JSON.parse(e);let a='50',i='20';t.x<100&&t.x>0&&(a=t.x),t.y<100&&t.y>0&&(i=t.y),n.style.left=a+'%',n.style.top=i+'%'}}(),Z.addEventListener('timeupdate',en),o.music.updateFullList()}),(0,a.onBeforeUnmount)(()=>{$('body').off('mousemove',hn),$('body').off('mouseup',bn),$('body').off('touchmove',hn),$('body').off('touchend',bn),$('body').off('visibilitychange',kn),$('body').off('click',En),$('body').off('keydown',Sn),window.removeEventListener('resize',wn),Z.removeEventListener('timeupdate',en)}),(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{id:'lyricsWidget',ref_key:'widget',ref:on,class:'lyrics-widget player-card',style:(0,a.normalizeStyle)(`top:${An.value};left:${dn.value}`),onMousedown:xn,onTouchstart:xn,onContextmenu:Bn},[e[19]||(e[19]=(0,a.createElementVNode)('div',{class:'story-ring'},null,-1)),(0,a.createCommentVNode)(' 找到这一块 '),(0,a.createElementVNode)('div',s,[(0,a.createCommentVNode)(' 修改这行 img 标签 '),(0,a.createCommentVNode)(' 1. draggable=\"false\": 告诉浏览器这图不能拖出去 '),(0,a.createCommentVNode)(' 2. style=\"pointer-events: none\": 让鼠标点击直接穿透到父容器，彻底杜绝图片被选中 '),(0,a.createElementVNode)('img',{src:t.value,alt:'Avatar',class:'avatar-img',draggable:'false',style:{'pointer-events':'none'}},null,8,r)]),(0,a.createCommentVNode)(' 右上角小气泡，点击这里展开 '),(0,a.createElementVNode)('div',{class:'expand-badge-btn',onClick:(0,a.withModifiers)(mn,['stop']),onTouchstart:(0,a.withModifiers)(mn,['stop'])},[...e[11]||(e[11]=[(0,a.createElementVNode)('i',{class:'fas fa-expand-arrows-alt'},null,-1)])],32),(0,a.createCommentVNode)(' === 展开状态 (保持之前的逻辑) === '),(0,a.createElementVNode)('div',l,[(0,a.createElementVNode)('div',c,[(0,a.createElementVNode)('div',d,[(0,a.createElementVNode)('div',{class:'ins-avatar-small',onClick:(0,a.withModifiers)(V,['stop'])},[(0,a.createElementVNode)('img',{src:t.value,class:'avatar-img'},null,8,A)]),(0,a.createElementVNode)('input',{ref_key:'fileInputRef',ref:i,type:'file',accept:'image/*',style:{display:'none'},onChange:Y},null,544),(0,a.createElementVNode)('div',u,[(0,a.createElementVNode)('div',p,(0,a.toDisplayString)(I.value||'Неизвестный исполнитель'),1),(0,a.createElementVNode)('div',C,(0,a.toDisplayString)(P.value||'Музыкальный плеер'),1)])]),(0,a.createCommentVNode)(' 头部按钮 '),(0,a.createElementVNode)('div',f,[(0,a.createCommentVNode)(' 列表按钮 '),(0,a.createElementVNode)('div',{class:'ins-icon-btn',onClick:(0,a.withModifiers)(Q,['stop'])},[(0,a.createElementVNode)('i',{class:(0,a.normalizeClass)(['fas',q.value?'fa-align-left':'fa-list'])},null,2)]),(0,a.createCommentVNode)(' 收起按钮 '),(0,a.createElementVNode)('div',{class:'ins-icon-btn close-btn',onClick:(0,a.withModifiers)(vn,['stop'])},[...e[12]||(e[12]=[(0,a.createElementVNode)('i',{class:'fas fa-chevron-down'},null,-1)])])])]),(0,a.createCommentVNode)(' 内容区域（移除了点击收缩） '),(0,a.createElementVNode)('div',g,[(0,a.withDirectives)((0,a.createElementVNode)('div',m,[(0,a.createElementVNode)('div',v,(0,a.toDisplayString)(T.value),1),(0,a.createElementVNode)('div',h,(0,a.toDisplayString)(W.value),1)],512),[[a.vShow,!q.value]]),(0,a.createCommentVNode)(' Плейлист '),(0,a.withDirectives)((0,a.createElementVNode)('div',{class:'playlist-wrapper',onClick:e[1]||(e[1]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:e[2]||(e[2]=(0,a.withModifiers)(()=>{},['stop'])),onTouchmove:e[3]||(e[3]=(0,a.withModifiers)(()=>{},['stop'])),onTouchend:e[4]||(e[4]=(0,a.withModifiers)(()=>{},['stop']))},[(0,a.createElementVNode)('div',b,[e[13]||(e[13]=(0,a.createElementVNode)('i',{class:'fas fa-search search-icon'},null,-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':e[0]||(e[0]=n=>H.value=n),type:'text',placeholder:'Поиск песни...',onKeyup:(0,a.withKeys)(J,['enter'])},null,544),[[a.vModelText,H.value]])]),(0,a.createElementVNode)('ul',x,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(o).music.list,(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('li',{key:t,class:(0,a.normalizeClass)(['song-item',{'is-playing':t===(0,a.unref)(o).music.index}]),onClick:n=>function(n){n===o.music.index&&D.value||(o.music.index=n,an(n))}(t)},[(0,a.createElementVNode)('div',B,[(0,a.createElementVNode)('span',w,(0,a.toDisplayString)(t+1),1),(0,a.createElementVNode)('span',k,(0,a.toDisplayString)(n.song||n.name||'未知歌曲'),1)]),(0,a.createElementVNode)('span',{class:'delete-btn',onClick:(0,a.withModifiers)(n=>function(n){n<o.music.index?o.music.index--:o.music.index,o.music.removeSong(n)}(t),['stop'])},[...e[14]||(e[14]=[(0,a.createElementVNode)('i',{class:'fas fa-times'},null,-1)])],8,E)],10,y))),128)),0===(0,a.unref)(o).music.list.length?((0,a.openBlock)(),(0,a.createElementBlock)('li',S,'Пока нет песен')):(0,a.createCommentVNode)('v-if',!0)])],544),[[a.vShow,q.value]])]),(0,a.createElementVNode)('div',{class:'ins-actions controls-area',onClick:e[10]||(e[10]=(0,a.withModifiers)(()=>{},['stop']))},[(0,a.createElementVNode)('div',M,[(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['ins-btn btn-like',{'is-active':D.value}]),onClick:e[5]||(e[5]=n=>tn(n,D.value?'stop':'play'))},[(0,a.createElementVNode)('i',{class:(0,a.normalizeClass)([D.value?'fas fa-heart':'far fa-heart'])},null,2)],2),(0,a.createElementVNode)('button',{class:'ins-btn',onClick:e[6]||(e[6]=n=>tn(n,'prev'))},[...e[15]||(e[15]=[(0,a.createElementVNode)('i',{class:'fas fa-step-backward'},null,-1)])]),(0,a.createElementVNode)('button',{class:'ins-btn',onClick:e[7]||(e[7]=n=>tn(n,'next'))},[...e[16]||(e[16]=[(0,a.createElementVNode)('i',{class:'fas fa-step-forward'},null,-1)])])]),(0,a.createElementVNode)('div',L,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':e[8]||(e[8]=n=>U.value=n),type:'range',class:'volume-slider volume-track',min:'0',max:'100',style:(0,a.normalizeStyle)({'--volume-fill':U.value+'%'}),onClick:e[9]||(e[9]=(0,a.withModifiers)(()=>{},['stop']))},null,4),[[a.vModelText,U.value]])])]),e[18]||(e[18]=(0,a.createElementVNode)('div',{class:'ins-likes'},[(0,a.createElementVNode)('span',null,[(0,a.createTextVNode)('Понравилось '),(0,a.createElementVNode)('b',null,'вам')])],-1)),(0,a.createElementVNode)('div',F,[(0,a.createElementVNode)('b',null,(0,a.toDisplayString)(I.value),1),e[17]||(e[17]=(0,a.createTextVNode)()),(0,a.createElementVNode)('span',N,(0,a.toDisplayString)(P.value),1)])])],36))}});t(163);const Y=(0,t(400).A)(V,[['__scopeId','data-v-56cdfa4a']]),D=(0,a.createApp)(Y);function U(){return globalThis.Music?Promise.resolve():new Promise((n,e)=>{const t=document.createElement('script');t.src='https://drive.baibai.cv/f/ZKEBuW/Music.js',t.onload=()=>n(),t.onerror=()=>e(),document.head.appendChild(t)})}async function T(n,e){if(console.log(n),e-=1,'消息生成完成'==n){const n=await getChatMessages(`${e}-${e}`,{role:'all'}),t=o.music.chatList.filter(n=>n.message_id!==e);for(const e of n){const n=[...e.message.matchAll(o.music.regex)];if(0==n.length)continue;const a=n.at(-1),i={song:a[1],singer:a[2],message_id:e.message_id};t.push(i)}t.sort((n,e)=>n.message_id-e.message_id),o.music.chatList=t,o.music.updateFullList(),-1===o.music.index&&o.music.list.length>0&&(o.music.index=o.music.list.length-1)}else await o.music.getAllChatMessages()}function W(){try{$(`head > div[script_id=\"${getScriptId()}\"]`).remove()}catch{console.log('移除样式时出现Ошибка')}}function P(){try{$(`div[script_id=\"${getScriptId()}\"]`).remove()}catch{console.log('移除div时出现Ошибка')}}$(async()=>{try{await U(),await function(){try{W(),P()}catch{}const n=$('<div>').attr('script_id',getScriptId());$('body').append(n),D.mount(n[0]),function(){try{if($(`head > div[script_id=\"${getScriptId()}\"]`).length>0)return;const n=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone());$('head').append(n)}catch{console.log('移动css样式时出错')}}()}(),console.log('Играть器加载完成!!!!!!!!!!!!!!!!!'),eventOn(tavern_events.CHAT_CHANGED,()=>T('聊天切换')),eventOn(tavern_events.MESSAGE_UPDATED,n=>T('消息更新',n)),eventOn(tavern_events.GENERATION_ENDED,n=>T('消息生成完成',n)),eventOn(tavern_events.MESSAGE_SWIPED,()=>T('消息切换')),eventOn(tavern_events.MESSAGE_DELETED,()=>T('消息删除')),eventOn(tavern_events.MESSAGE_SENT,()=>{console.log('消息已发送')}),eventOn(tavern_events.GENERATION_STOPPED,()=>{console.log('生成Пауза')}),await o.music.getAllChatMessages()}catch(n){console.error(n),toastr.error(`手机出现Ошибка:${n}`)}}),$(window).on('pagehide',()=>{console.log('触发了pagehide');try{D.unmount(),W(),P()}catch{}});export{U as ensureMusicLoaded};\n//# sourceMappingURL=index.js.map",
  "info": "",
  "button": {
    "enabled": true,
    "buttons": [
      {
        "name": "手机显隐切换",
        "visible": true
      },
      {
        "name": "重新处理所有消息",
        "visible": true
      }
    ]
  },
  "data": {}
}